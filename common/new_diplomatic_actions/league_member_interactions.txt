
#Ask for League Member
ask_for_league_member_subject = {
	category = influence
	alert_index = 41
	alert_tooltip = ask_for_league_member_subject_alert_tooltip.1
	
	require_acceptance = yes
	is_visible = {
		is_subject = no
		OR = {
			culture_group = hellenic
			culture_group = macedon_group
		}
		neither_tribal_nor_native_trigger = yes
		FROM = {
			NOT = { is_subject_of = ROOT }
			OR = {
				culture_group = hellenic
				culture_group = macedon_group
			}
		}
	}
	is_allowed = {
		reverse_has_opinion = {
			who = FROM
			value = 100
		}
		total_development = FROM
		is_bankrupt = no
		is_at_war = no
		stability = 0
		NOT = { is_rival = FROM }
		NOT = { truce_with = FROM }
		FROM = { is_subject = no }
		FROM = { NOT = { has_country_modifier = banned_league_modifier } }
		FROM = { NOT = { league_member_subject = 1 } }
		FROM = { NOT = { government_rank = 3 } }
		FROM = { NOT = { is_rival = ROOT } }
		FROM = { NOT = { any_ally = { is_rival = ROOT } } }
		FROM = { is_at_war = no }
	}
	on_accept = {
		add_prestige = 2
		create_subject = {
			subject_type = league_member_subject
			subject = FROM
		}
	}
	
	ai_acceptance = {
		add_entry = {
			name = TOTAL_DEVELOPMENT
			export_to_variable = {
				variable_name = ai_value
				value = total_development
				who = FROM
			}
			multiply_variable = { which = ai_value value = -2 }
		}
		add_entry = {
			name = BORDER_DISTANCE
			export_to_variable = {
				variable_name = ai_value
				value = border_distance
				who = FROM
				with = ROOT
			}
			change_variable = {	which = ai_value value = 2.5 } #round
			divide_variable = { which = ai_value value = -5 }
		}
		add_entry = {
			name = TRUST
			export_to_variable = {
				variable_name = ai_value
				value = trust
				who = FROM
				with = ROOT
			}
			subtract_variable = { which = ai_value value = 50 }
			divide_variable = { which = ai_value value = 2 } #max = 25
		}
		add_entry = {
			name = ARMY_SIZE
			export_to_variable = {
				variable_name = ai_value
				value = land_forcelimit
				who = ROOT
			}
			change_variable = {	which = ai_value value = 1.5 } #round
			divide_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = NAVY_SIZE
			export_to_variable = {
				variable_name = ai_value
				value = naval_forcelimit
				who = ROOT
			}
			change_variable = {	which = ai_value value = 3 } #round
			divide_variable = { which = ai_value value = 6 }
		}
		add_entry = {
			name = NUMBER_OF_SUBJECTS #avoid infinite vassal swarm since they take no diplo slot
			export_to_variable = {
				variable_name = ai_value
				value = trigger_value:num_of_subjects
				who = ROOT
			}
			multiply_variable = { which = ai_value value = -2 }
		}
		add_entry = {
			name = PRESTIGE
			export_to_variable = {
				variable_name = ai_value
				value = prestige
				who = ROOT
			}
			change_variable = { which = ai_value value = 2.5 } 	#round
			divide_variable = { which = ai_value value = 5 } 	#max = 20
		}
		add_entry = {
			name = DIP_REPUTATION
			export_to_variable = {
				variable_name = ai_value
				value = modifier:diplomatic_reputation
				with = ROOT
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = DIFFERENT_PRIMARY_CULTURE
			limit = { NOT = { primary_culture = FROM } }
			export_to_variable = {
				which = ai_value
				value = -10
			}
		}
		add_entry = {
			name = DIFFERENT_CULTURE_GROUP #should make it really more difficult
			limit = { NOT = { culture_group = FROM } }
			export_to_variable = {
				which = ai_value
				value = -40
			}
		}
		add_entry = {
			name = BASE_VALUE_CUSTOM
			limit = { FROM = { ai = yes } }
			export_to_variable = {
				which = ai_value
				value = -10
			}
		}
	}
	
	ai_will_do = {
	}
}

#Removes League Member
remove_league_member_subject = {
	category = influence
	alert_index = 41
	alert_tooltip = remove_league_member_subject_alert_tooltip.1
	
	require_acceptance = no
	is_visible = {
		FROM = {
			is_subject_of_type = league_member_subject
			is_subject_of = ROOT
		}
	}
	is_allowed = {
		is_at_war = no
		has_any_disaster = no
		FROM = {
			is_subject_of_type = league_member_subject
			is_subject_of = ROOT
		}
	}
	on_accept = {
		add_truce_with = FROM
		FROM = {
			grant_independence = yes
			add_country_modifier = {
				name = banned_league_modifier
				duration = 730
			}
			add_opinion = {
				who = ROOT
    			modifier = banned_from_league_opinion
			}
		}
		add_prestige = -5
	}
	
	ai_will_do = {
		FROM = {
			OR = {
				total_development = ROOT
				liberty_desire = 70
				AND = {
					liberty_desire = 60
					reverse_has_opinion = {
						who = FROM
						NOT = { value = 100 }
					}
				}
			}
		}
	}
}

#Settle Clerurchy
settle_clerurchy_interaction = {
	category = influence
	alert_index = 41
	alert_tooltip = settle_clerurchy_interaction_alert_tooltip.1
	require_acceptance = no

	is_visible = {
		FROM = {
			is_subject_of_type = league_member_subject
			is_subject_of = ROOT
		}
		league_member_subject = 6
		NOT = { has_country_modifier = settled_clerurch_modifier }
	}
	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of_type = league_member_subject
				is_subject_of = ROOT
			}
			league_member_subject = 6
			NOT = { has_country_modifier = settled_clerurch_modifier }
		}
		is_at_war = no
		has_any_disaster = no
		absolutism = 20
		stability = 1
		capital_scope = { base_manpower = 2 }
		FROM = {
			NOT = { total_development = ROOT }
			NOT = { army_size = ROOT }
			NOT = { navy_size = ROOT }
			NOT = { liberty_desire = 50 }
			has_opinion = {
				who = ROOT
				value = 50
			}
		}
	}
	on_accept = {
		add_absolutism = -5
		add_country_modifier = {
			name = settled_clerurch_modifier
			duration = 3650
		}
		every_subject_country = {
			limit = {
				is_subject_of_type = league_member_subject
				NOT = { TAG = FROM }
			}
			add_opinion = {
				who = ROOT
    			modifier = banned_from_league_opinion
			}
			add_liberty_desire = 5
		}
		hidden_effect = {
			capital_scope = { add_base_manpower = -1 }
			FROM = {
				random_owned_province = {
					if = {
						limit = { is_prosperous = yes }
						add_core = ROOT
						cede_province = ROOT
						change_culture = ROOT
						change_religion = ROOT
						add_base_production = -1
					}
					else = {
						add_core = ROOT
						cede_province = ROOT
						change_culture = ROOT
						change_religion = ROOT
						add_base_production = -1
					}
				}
			}
		}
		FROM = {
			if = {
				limit = { exists = yes }
				add_opinion = {
					who = ROOT
					modifier = recently_settled_clerurch_opinion
				}
				add_liberty_desire = 20
			}
		}
	}
	
	ai_will_do = {
		personality = ai_militarist
		stability = 1
		absolutism = 30
		total_development = 60
		FROM = {
			NOT = { total_development = ROOT }
			NOT = { liberty_desire = 60 }
		}
	}
}
