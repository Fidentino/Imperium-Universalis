PV_find_goods_price = {
	trigger_switch = {
		on_trigger = trade_goods
		grain = { 		set_variable = { which = PV_price value = 0.75 } }
		wine = { 		set_variable = { which = PV_price value = 3.00 } }
		wool = { 		set_variable = { which = PV_price value = 1.00 } }
		cloth = { 		set_variable = { which = PV_price value = 2.5 } }
		fish = { 		set_variable = { which = PV_price value = 1.5 } }
		
		fur = { 		set_variable = { which = PV_price value = 2.5 } }
		salt = { 		set_variable = { which = PV_price value = 3.0 } }
		naval_supplies = { set_variable = { which = PV_price value = 2.0 } }
		copper = { 		set_variable = { which = PV_price value = 4.0 } }
		gold = { 		set_variable = { which = PV_price value = 8.5 } }
		
		iron = { 		set_variable = { which = PV_price value = 3.5 } }
		horses = { 		set_variable = { which = PV_price value = 2.5 } }
		spices = { 		set_variable = { which = PV_price value = 3.5 } }
		fruits = { 		set_variable = { which = PV_price value = 2.0 } }
		amber = { 		set_variable = { which = PV_price value = 4.0 } }
		
		silver = { 		set_variable = { which = PV_price value = 7.0 } }
		marble = { 		set_variable = { which = PV_price value = 4.0 } }
		olive = { 		set_variable = { which = PV_price value = 2.5 } }
		paper = { 		set_variable = { which = PV_price value = 5.0 } }
		ceramic = { 	set_variable = { which = PV_price value = 2.0 } }
		
		meat_animals = { set_variable = { which = PV_price value = 1.5 } }
		dyes = { 		set_variable = { which = PV_price value = 4.0 } }
		honey = { 		set_variable = { which = PV_price value = 2.0 } }
		lead = { 		set_variable = { which = PV_price value = 2.0 } }
		glas = { 		set_variable = { which = PV_price value = 3.0 } }
		
		silk = { 		set_variable = { which = PV_price value = 4.5 } }
		olibanum = { 	set_variable = { which = PV_price value = 4.0 } }
		pearls = { 		set_variable = { which = PV_price value = 4.0 } }
		exotic_animals = { set_variable = { which = PV_price value = 3.5 } }
		herbs = { 		set_variable = { which = PV_price value = 2.0 } }
		
		ivory = { 		set_variable = { which = PV_price value = 3.5 } }
		jade = { 		set_variable = { which = PV_price value = 5.0 } }
		tin = { 		set_variable = { which = PV_price value = 4.0 } }
		rice = { 		set_variable = { which = PV_price value = 0.5 } }
		gems = { 		set_variable = { which = PV_price value = 5.0 } }
		
		cotton = { 		set_variable = { which = PV_price value = 3.0 } }
		tar_good = { 	set_variable = { which = PV_price value = 3.0 } }
		tea_good = { 	set_variable = { which = PV_price value = 2.5 } }
		opium = { 		set_variable = { which = PV_price value = 3.0 } }
		metalware = { 	set_variable = { which = PV_price value = 5.75 } }
		
		sugar = { 		set_variable = { which = PV_price value = 4.0 } }
		
	}
	
	if = { limit = { has_global_flag = amber_price_increased 	trade_goods = amber }			multiply_variable = { PV_price = 1.50 } }
	if = { limit = { has_global_flag = lead_price_increased 	trade_goods = lead } 			multiply_variable = { PV_price = 1.60 } }
	if = { limit = { has_global_flag = paper_price_changed 		trade_goods = paper }			multiply_variable = { PV_price = 0.75 } }
	if = { limit = { has_global_flag = paper_price_changed 		trade_goods = meat_animals }	multiply_variable = { PV_price = 1.10 } }
	if = { limit = { has_global_flag = wood_price_changed 		trade_goods = naval_supplies }	multiply_variable = { PV_price = 1.50 } }
	if = { limit = { has_global_flag = marble_price_changed 	trade_goods = marble }			multiply_variable = { PV_price = 1.40 } }
	if = { limit = { has_global_flag = olibanum_price_changed 	trade_goods = olibanum }		multiply_variable = { PV_price = 1.50 } }
	if = { limit = { has_global_flag = ivory_price_changed 		trade_goods = ivory }			multiply_variable = { PV_price = 1.20 } }
	if = { limit = { has_global_flag = exotic_animals_price_changed	trade_goods = exotic_animals }	multiply_variable = { PV_price = 1.5 } }
	if = { limit = { has_global_flag = iron_price_changed 		trade_goods = iron }			multiply_variable = { PV_price = 1.25 } }
	if = { limit = { has_global_flag = iron_price_changed 		trade_goods = copper }			multiply_variable = { PV_price = 0.75 } }
	if = { limit = { has_global_flag = glass_price_changed 		trade_goods = glas }			multiply_variable = { PV_price = 1.50 } }
	if = { limit = { has_global_flag = glass_price_changed 		trade_goods = ceramic }			multiply_variable = { PV_price = 0.90 } }
	if = { limit = { has_global_flag = cloths_price_changed 	trade_goods = cloth }			multiply_variable = { PV_price = 1.50 } }
	if = { limit = { has_global_flag = cloths_price_changed 	trade_goods = wool }			multiply_variable = { PV_price = 1.25 } }
	if = { limit = { has_global_flag = cloths_price_changed 	trade_goods = dyes }			multiply_variable = { PV_price = 1.50 } }
	if = { limit = { has_global_flag = extiction_of_the_european_lion trade_goods = exotic_animals } multiply_variable = { PV_price = 1.25 } }
	
	# I could have done a trigger_switch, but then it is not efficient when you need more than one condition at once, and it's two triggers at once (trade good + global flag)
	
	
}

resource_supplydemand = {
	
	export_to_variable = { which = supply_mod value = modifier:trade_goods_size_modifier } 
	change_variable = { supply_mod = 1 }	
	export_to_variable = { which = gsupply value = modifier:trade_goods_size }		
	multiply_variable = { which = gsupply which = supply_mod } 
		
	
	trigger_switch = {
		on_trigger = trade_goods
		grain = { 		
			set_variable = { which = sup$regid$_grain which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_grain which = PREV } }
		}
		wine = { 	 		
			set_variable = { which = sup$regid$_wine which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_wine which = PREV } }
		}	
		wool = { 		 		
			set_variable = { which = sup$regid$_wool which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_wool which = PREV } }
		}
		cloth = { 		 		
			set_variable = { which = sup$regid$_cloth which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_cloth which = PREV } }
		}
		fish = { 		 		
			set_variable = { which = sup$regid$_fish which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_fish which = PREV } }
		}
		
		fur = { 		 		
			set_variable = { which = sup$regid$_fur which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_fur which = PREV } }
		}
		salt = { 		 		
			set_variable = { which = sup$regid$_salt which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_salt which = PREV } }
		}
		naval_supplies = {  		
			set_variable = { which = sup$regid$_timber which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_timber which = PREV } }
		}
		copper = { 		 		
			set_variable = { which = sup$regid$_copper which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_copper which = PREV } }
		}
		#gold
		
		iron = { 		 		
			set_variable = { which = sup$regid$_iron which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_iron which = PREV } }
		}
		horses = { 		 		
			set_variable = { which = sup$regid$_horses which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_horses which = PREV } }
		}
		spices = { 		 		
			set_variable = { which = sup$regid$_spices which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_spices which = PREV } }
		}
		fruits = { 		 		
			set_variable = { which = sup$regid$_fruits which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_fruits which = PREV } }
		}
		amber = { 		 		
			set_variable = { which = sup$regid$_amber which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_amber which = PREV } }
		}
		
		#silver
		marble = { 		 		
			set_variable = { which = sup$regid$_marble which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_marble which = PREV } }
		}
		olive = { 		 		
			set_variable = { which = sup$regid$_olive which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_olive which = PREV } }
		}
		paper = { 		 		
			set_variable = { which = sup$regid$_paper which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_paper which = PREV } }
		}
		ceramic = { 	 		
			set_variable = { which = sup$regid$_ceramic which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_ceramic which = PREV } }
		}		
		meat_animals = {  		
			set_variable = { which = sup$regid$_meat which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_meat which = PREV } }
		}
		dyes = { 		 		
			set_variable = { which = sup$regid$_dyes which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_dyes which = PREV } }
		}
		honey = { 		 		
			set_variable = { which = sup$regid$_honey which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_honey which = PREV } }
		}
		lead = { 		 		
			set_variable = { which = sup$regid$_lead which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_lead which = PREV } }
		}
		glas = { 		 		
			set_variable = { which = sup$regid$_glas which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_glas which = PREV } }
		}
		
		silk = { 		 		
			set_variable = { which = sup$regid$_silk which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_silk which = PREV } }
		}
		olibanum = { 	 		
			set_variable = { which = sup$regid$_oliban which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_oliban which = PREV } }
		}
		pearls = { 		 		
			set_variable = { which = sup$regid$_pearls which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_pearls which = PREV } }
		}
		exotic_animals = {  		
			set_variable = { which = sup$regid$_exotics which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_exotics which = PREV } }
		}
		herbs = { 		 		
			set_variable = { which = sup$regid$_herbs which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_herbs which = PREV } }
		}
		
		ivory = { 		 		
			set_variable = { which = sup$regid$_ivory which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_ivory which = PREV } }
		}
		jade = { 		 		
			set_variable = { which = sup$regid$_jade which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_jade which = PREV } }
		}
		tin = { 		 		
			set_variable = { which = sup$regid$_tin which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_tin which = PREV } }
		}
		rice = { 		 		
			set_variable = { which = sup$regid$_rice which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_rice which = PREV } }
		}
		gems = { 		 		
			set_variable = { which = sup$regid$_gems which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_gems which = PREV } }
		}
		
		cotton = { 		 		
			set_variable = { which = sup$regid$_cotton which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_cotton which = PREV } }
		}
		tar_good = { 	 		
			set_variable = { which = sup$regid$_targ which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_targ which = PREV } }
		}
		tea_good = { 	 		
			set_variable = { which = sup$regid$_teag which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_teag which = PREV } }
		}
		opium = { 		 		
			set_variable = { which = sup$regid$_opium which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_opium which = PREV } }
		}
		metalware = { 	 		
			set_variable = { which = sup$regid$_metal which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_metal which = PREV } }
		}
		
		sugar = { 		 		
			set_variable = { which = sup$regid$_sugar which = gsupply } 
			ROOT = { change_variable = { which = sup$regid$_sugar which = PREV } }
		}
		
	}
}

DE_cleanup_prior_prices = {
	set_variable = { which = DE_sup_grain value = 0 }
	set_variable = { which = DE_sup_wine value = 0 }
	set_variable = { which = DE_sup_wool value = 0 }
	set_variable = { which = DE_sup_cloth value = 0 }
	set_variable = { which = DE_sup_fish value = 0 }

	set_variable = { which = DE_sup_fur value = 0 }
	set_variable = { which = DE_sup_salt value = 0 }
	set_variable = { which = DE_sup_naval value = 0 }
	set_variable = { which = DE_sup_copper value = 0 }
	set_variable = { which = DE_sup_gold value = 0 }

	set_variable = { which = DE_sup_iron value = 0 }
	set_variable = { which = DE_sup_horses value = 0 }
	set_variable = { which = DE_sup_spices value = 0 }
	set_variable = { which = DE_sup_fruits value = 0 }
	set_variable = { which = DE_sup_amber value = 0 }

	set_variable = { which = DE_sup_silver value = 0 }
	set_variable = { which = DE_sup_marble value = 0 }
	set_variable = { which = DE_sup_olive value = 0 }
	set_variable = { which = DE_sup_paper value = 0 }
	set_variable = { which = DE_sup_ceramic value = 0 }

	set_variable = { which = DE_sup_meatan value = 0 }
	set_variable = { which = DE_sup_dyes value = 0 }
	set_variable = { which = DE_sup_honey value = 0 }
	set_variable = { which = DE_sup_lead value = 0 }
	set_variable = { which = DE_sup_glas value = 0 }

	set_variable = { which = DE_sup_silk value = 0 }
	set_variable = { which = DE_sup_olibanum value = 0 }
	set_variable = { which = DE_sup_pearls value = 0 }
	set_variable = { which = DE_sup_exotics value = 0 }
	set_variable = { which = DE_sup_herbs value = 0 }

	set_variable = { which = DE_sup_ivory value = 0 }
	set_variable = { which = DE_sup_jade value = 0 }
	set_variable = { which = DE_sup_tin value = 0 }
	set_variable = { which = DE_sup_rice value = 0 }
	set_variable = { which = DE_sup_gems value = 0 }

	set_variable = { which = DE_sup_cotton value = 0 }
	set_variable = { which = DE_sup_targood value = 0 }
	set_variable = { which = DE_sup_teagood value = 0 }
	set_variable = { which = DE_sup_opium value = 0 }
	set_variable = { which = DE_sup_metalware value = 0 }

	set_variable = { which = DE_sup_sugar value = 0 }
	
	set_variable = { which = DE_rur value = 0 }
	set_variable = { which = DE_urb value = 0 }
	set_variable = { which = DE_upp value = 0 }
	
	
}

DE_cleanup_flags = {
	clr_global_flag = DE_basfood_verylow
	clr_global_flag = DE_basfood_low
	clr_global_flag = DE_basfood_stagnant
	clr_global_flag = DE_basfood_normal
	clr_global_flag = DE_basfood_rising
	clr_global_flag = DE_basfood_high
	clr_global_flag = DE_basfood_veryhigh
	
	clr_global_flag = DE_normfood_verylow
	clr_global_flag = DE_normfood_low
	clr_global_flag = DE_normfood_stagnant
	clr_global_flag = DE_normfood_normal
	clr_global_flag = DE_normfood_rising
	clr_global_flag = DE_normfood_high
	clr_global_flag = DE_normfood_veryhigh
	
	clr_global_flag = DE_normgood_verylow
	clr_global_flag = DE_normgood_low
	clr_global_flag = DE_normgood_stagnant
	clr_global_flag = DE_normgood_normal
	clr_global_flag = DE_normgood_rising
	clr_global_flag = DE_normgood_high
	clr_global_flag = DE_normgood_veryhigh
	
	clr_global_flag = DE_luxgood_verylow
	clr_global_flag = DE_luxgood_low
	clr_global_flag = DE_luxgood_stagnant
	clr_global_flag = DE_luxgood_normal
	clr_global_flag = DE_luxgood_rising
	clr_global_flag = DE_luxgood_high
	clr_global_flag = DE_luxgood_veryhigh
	
	clr_global_flag = DE_civgood_verylow
	clr_global_flag = DE_civgood_low
	clr_global_flag = DE_civgood_stagnant
	clr_global_flag = DE_civgood_normal
	clr_global_flag = DE_civgood_rising
	clr_global_flag = DE_civgood_high
	clr_global_flag = DE_civgood_veryhigh
	
	clr_global_flag = DE_miligood_verylow
	clr_global_flag = DE_miligood_low
	clr_global_flag = DE_miligood_stagnant
	clr_global_flag = DE_miligood_normal
	clr_global_flag = DE_miligood_rising
	clr_global_flag = DE_miligood_high
	clr_global_flag = DE_miligood_veryhigh
	
	clr_global_flag = DE_copper_verylow
	clr_global_flag = DE_copper_low
	clr_global_flag = DE_copper_stagnant
	clr_global_flag = DE_copper_normal
	clr_global_flag = DE_copper_rising
	clr_global_flag = DE_copper_high
	clr_global_flag = DE_copper_veryhigh
	
	clr_global_flag = DE_iron_verylow
	clr_global_flag = DE_iron_low
	clr_global_flag = DE_iron_stagnant
	clr_global_flag = DE_iron_normal
	clr_global_flag = DE_iron_rising
	clr_global_flag = DE_iron_high
	clr_global_flag = DE_iron_veryhigh
	
	clr_global_flag = DE_tin_verylow
	clr_global_flag = DE_tin_low
	clr_global_flag = DE_tin_stagnant
	clr_global_flag = DE_tin_normal
	clr_global_flag = DE_tin_rising
	clr_global_flag = DE_tin_high
	clr_global_flag = DE_tin_veryhigh
	
	clr_global_flag = DE_lead_verylow
	clr_global_flag = DE_lead_low
	clr_global_flag = DE_lead_stagnant
	clr_global_flag = DE_lead_normal
	clr_global_flag = DE_lead_rising
	clr_global_flag = DE_lead_high
	clr_global_flag = DE_lead_veryhigh
	
}

DE_cleanup_prices_post = {
	set_variable = { which = DE_sup_grain value = 0 }
	set_variable = { which = DE_sup_wine value = 0 }
	set_variable = { which = DE_sup_wool value = 0 }
	set_variable = { which = DE_sup_cloth value = 0 }
	set_variable = { which = DE_sup_fish value = 0 }

	set_variable = { which = DE_sup_fur value = 0 }
	set_variable = { which = DE_sup_salt value = 0 }
	set_variable = { which = DE_sup_naval value = 0 }
	set_variable = { which = DE_sup_copper value = 0 }
	set_variable = { which = DE_sup_gold value = 0 }

	set_variable = { which = DE_sup_iron value = 0 }
	set_variable = { which = DE_sup_horses value = 0 }
	set_variable = { which = DE_sup_spices value = 0 }
	set_variable = { which = DE_sup_fruits value = 0 }
	set_variable = { which = DE_sup_amber value = 0 }

	set_variable = { which = DE_sup_silver value = 0 }
	set_variable = { which = DE_sup_marble value = 0 }
	set_variable = { which = DE_sup_olive value = 0 }
	set_variable = { which = DE_sup_paper value = 0 }
	set_variable = { which = DE_sup_ceramic value = 0 }

	set_variable = { which = DE_sup_meatan value = 0 }
	set_variable = { which = DE_sup_dyes value = 0 }
	set_variable = { which = DE_sup_honey value = 0 }
	set_variable = { which = DE_sup_lead value = 0 }
	set_variable = { which = DE_sup_glas value = 0 }

	set_variable = { which = DE_sup_silk value = 0 }
	set_variable = { which = DE_sup_olibanum value = 0 }
	set_variable = { which = DE_sup_pearls value = 0 }
	set_variable = { which = DE_sup_exotics value = 0 }
	set_variable = { which = DE_sup_herbs value = 0 }

	set_variable = { which = DE_sup_ivory value = 0 }
	set_variable = { which = DE_sup_jade value = 0 }
	set_variable = { which = DE_sup_tin value = 0 }
	set_variable = { which = DE_sup_rice value = 0 }
	set_variable = { which = DE_sup_gems value = 0 }

	set_variable = { which = DE_sup_cotton value = 0 }
	set_variable = { which = DE_sup_targood value = 0 }
	set_variable = { which = DE_sup_teagood value = 0 }
	set_variable = { which = DE_sup_opium value = 0 }
	set_variable = { which = DE_sup_metalware value = 0 }

	set_variable = { which = DE_sup_sugar value = 0 }
	
	set_variable = { which = DE_rur value = 0 }
	set_variable = { which = DE_urb value = 0 }
	set_variable = { which = DE_upp value = 0 }
	
	set_variable = { which = DE_dem_rurals value = 0 }
	set_variable = { which = DE_dem_urbans value = 0 }
	set_variable = { which = DE_dem_uppers value = 0 }
	set_variable = { which = DE_sup_basfood value = 0 }
	set_variable = { which = DE_sup_normfood value = 0 }
	set_variable = { which = DE_sup_normgood value = 0 }
	set_variable = { which = DE_sup_luxgood value = 0 }
	set_variable = { which = DE_sup_civgood value = 0 }
	set_variable = { which = DE_sup_miligood value = 0 }
	set_variable = { which = DE_dem_basfood value = 0 }
	set_variable = { which = DE_dem_normfood value = 0 }
	set_variable = { which = DE_dem_normgood value = 0 }
	set_variable = { which = DE_dem_luxgood value = 0 }
	set_variable = { which = DE_dem_civgood value = 0 }
	set_variable = { which = DE_dem_miligood value = 0 }
	set_variable = { which = DE_dem_iron value = 0 }
	set_variable = { which = DE_dem_lead value = 0 }
	set_variable = { which = DE_dem_tin value = 0 }
	set_variable = { which = DE_dem_copper value = 0 }
	
}
DE_supply_effect = {
	set_variable = { which = DE_sup_$good$ which = DE_base_supply } 
	ROOT = { change_variable = { which = DE_sup_$good$ which = PREV } }
	set_variable = { which = DE_sup_$good$ value = 0 }
	
}

DE_find_supdem_price = {
	# avoid divide by zeros. Just in case
	if = { limit = { NOT = { check_variable = { DE_sup_$type$ = 1 } } } set_variable = { which = DE_sup_$type$ value = 1 } }
	
	divide_variable = { which = DE_dem_$type$ which = DE_sup_$type$ }
	if = { 		limit = { check_variable = { DE_dem_$type$ = 2.0 } } 	set_global_flag = DE_$type$_veryhigh }
	else_if = { limit = { check_variable = { DE_dem_$type$ = 1.5 } } 	set_global_flag = DE_$type$_high }
	else_if = { limit = { check_variable = { DE_dem_$type$ = 1.25 } } 	set_global_flag = DE_$type$_rising }
	else_if = { limit = { check_variable = { DE_dem_$type$ = 1.0 } } 	set_global_flag = DE_$type$_normal }
	else_if = { limit = { check_variable = { DE_dem_$type$ = 0.75 } } 	set_global_flag = DE_$type$_stagnant }
	else_if = { limit = { check_variable = { DE_dem_$type$ = 0.50 } } 	set_global_flag = DE_$type$_low }
	else = { 															set_global_flag = DE_$type$_verylow }
	
}


